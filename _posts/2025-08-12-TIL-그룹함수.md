---
layout: blog
title: 4.3 그룹함수
date: 2025-08-12 16:00:00 +0900
categories: [TIL, sqld, 4_SQL_활용]
permalink: /blog/posts/25-08-12-TIL
---

### 4.3.1 그룹함수의 개념

**그룹함수** : GROUP BY절에 따른 결과에 대해서 그룹별로 연산을 수행하는 함수. 집계함수가 그룹함수의 일종이다.

이후의 그룹함수 예제에서는 아래 테이블을 사용한다.

<table style="width:75%" border="1">
  <caption>STUDENT</caption>
  <thead>
    <tr>
      <th>DEPARTMENT</th>
      <th>GRADE</th>
      <th>SCORE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>소프트웨어학과</td>
      <td>1학년</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>소프트웨어학과</td>
      <td>2학년</td>
      <td>4.1</td>
    </tr>
    <tr>
      <td>소프트웨어학과</td>
      <td>2학년</td>
      <td>2.6</td>
    </tr>
    <tr>
      <td>소프트웨어학과</td>
      <td>3학년</td>
      <td>3.5</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td>2학년</td>
      <td>3.6</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td>3학년</td>
      <td>4.2</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td>4학년</td>
      <td>2.9</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td>4학년</td>
      <td>3.7</td>
    </tr>
  </tbody>
</table>
<br>

### 4.3.2 ROLLUP

**ROLLUP** : GROUP BY절에 들어가는 칼럼을 대상으로 하위 그룹핑을 수행하는 함수. 그룹을 대상으로 한 소계와 전체 총계를 자동으로 추가해 준다. GROUP BY ROLLUP(A, B)의 경우, (A, B) -> (A) -> (전체)의 순서로 하위 그룹핑을 수행한다.

<b>SELECT DEPARTMENT, GRADE, COUNT(\*)<br>
FROM STUDENT<br>
GROUP BY ROLLUP(DEPARTMENT, GRADE)<br>
ORDER BY DEPARTMENT, GRADE;<br></b>
=> 학과, 학년 별로 그룹핑하여 그룹별 개수를 구하고, 학과별 소계, 총계를 구한다.

<table style="width:75%" border="1">
  <caption>실행결과</caption>
  <thead>
    <tr>
      <th>DEPARTMENT</th>
      <th>GRADE</th>
      <th>COUNT(*)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>소프트웨어학과</td>
      <td>1학년</td>
      <td>1</td>
    </tr>
    <tr>
      <td>소프트웨어학과</td>
      <td>2학년</td>
      <td>2</td>
    </tr>
    <tr>
      <td>소프트웨어학과</td>
      <td>3학년</td>
      <td>1</td>
    </tr>
    <tr>
      <td>소프트웨어학과</td>
      <td class="grey">[NULL]</td>
      <td>4</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td>2학년</td>
      <td>1</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td>3학년</td>
      <td>1</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td>4학년</td>
      <td>2</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td class="grey">[NULL]</td>
      <td>4</td>
    </tr>
    <tr>
      <td class="grey">[NULL]</td>
      <td class="grey">[NULL]</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
<br>

### 4.3.3 CUBE

**CUBE** : ROLLUP과 비슷하지만, CUBE는 조합 가능한 모든 경우로 그룹핑을 수행한다. GROUP BY CUBE(A, B)의 경우, (A, B) -> (A) -> (B) -> (전체)의 순서로 하위 그룹핑을 수행한다.

<b>SELECT DEPARTMENT, GRADE, COUNT(\*)<br>
FROM STUDENT<br>
GROUP BY CUBE(DEPARTMENT, GRADE)<br>
ORDER BY DEPARTMENT, GRADE;<br></b>
=> 학과, 학년별로 그룹핑하여 그룹별 개수를 구하고, 학과별 소계, 학년별 소계, 총계를 구한다.

<table style="width:75%" border="1">
  <caption>실행결과</caption>
  <thead>
    <tr>
      <th>DEPARTMENT</th>
      <th>GRADE</th>
      <th>COUNT(*)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>소프트웨어학과</td>
      <td>1학년</td>
      <td>1</td>
    </tr>
    <tr>
      <td>소프트웨어학과</td>
      <td>2학년</td>
      <td>2</td>
    </tr>
    <tr>
      <td>소프트웨어학과</td>
      <td>3학년</td>
      <td>1</td>
    </tr>
    <tr>
      <td>소프트웨어학과</td>
      <td class="grey">[NULL]</td>
      <td>4</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td>2학년</td>
      <td>1</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td>3학년</td>
      <td>1</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td>4학년</td>
      <td>2</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td class="grey">[NULL]</td>
      <td>4</td>
    </tr>
    <tr>
      <td class="grey">[NULL]</td>
      <td>1학년</td>
      <td>1</td>
    </tr>
    <tr>
      <td class="grey">[NULL]</td>
      <td>2학년</td>
      <td>3</td>
    </tr>
    <tr>
      <td class="grey">[NULL]</td>
      <td>3학년</td>
      <td>2</td>
    </tr>
    <tr>
      <td class="grey">[NULL]</td>
      <td>4학년</td>
      <td>2</td>
    </tr>
    <tr>
      <td class="grey">[NULL]</td>
      <td class="grey">[NULL]</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
<br>

### 4.3.4 GROUPING SETS

**GROUPING SETS** : 그룹핑할 대상을 지정하는 함수. 입력된 인자에 대해서만 소계를 구한다. 인자에 ROLLUP, CUBE 함수를 넣을 수 있으며 이 경우 함수의 결과인 소계, 총계들이 각각 별개의 인자로 지정된 결과를 반환한다.

<b>SELECT DEPARTMENT, GRADE, COUNT(\*)<br>
FROM STUDENT<br>
GROUP BY GROUPING SETS(DEPARTMENT, GRADE)<br>
ORDER BY DEPARTMENT, GRADE;<br></b>
=> 학과, 학년별로 그룹핑하여 그룹별 개수를 반환한다.

<table style="width:75%" border="1">
  <caption>실행결과</caption>
  <thead>
    <tr>
      <th>DEPARTMENT</th>
      <th>GRADE</th>
      <th>COUNT(*)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>소프트웨어학과</td>
      <td class="grey">[NULL]</td>
      <td>4</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td class="grey">[NULL]</td>
      <td>4</td>
    </tr>
    <tr>
      <td class="grey">[NULL]</td>
      <td>1학년</td>
      <td>1</td>
    </tr>
    <tr>
      <td class="grey">[NULL]</td>
      <td>2학년</td>
      <td>3</td>
    </tr>
    <tr>
      <td class="grey">[NULL]</td>
      <td>3학년</td>
      <td>2</td>
    </tr>
    <tr>
      <td class="grey">[NULL]</td>
      <td>4학년</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<br>

### 4.3.5 GROUPING

**GROUPING** : ROLLUP, CUBE, GROUPING SETS와 함께 사용하여 소계에 해당하는 행과 그렇지 않은 행을 구분할 수 있도록 해준다. 결과 행에는 1을 반환하며, 일반 행에는 0을 반환한다.

<b>SELECT CASE GROUPING(DEPARTMENT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;WHEN 1 THEN '총계' ELSE DEPARTMENT<br>
&nbsp;&nbsp;&nbsp;&nbsp;END AS DEPARTMENT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;COUNT(\*)<br>
FROM STUDENT<br>
GROUP BY ROLLUP(DEPARTMENT)<br>
ORDER BY DEPARTMENT;<br></b>
=> 학과별로 그룹핑하며 마지막 총계 행에는 DEPARTMENT값을 '총계' 텍스트로 대체한다.

<table style="width:75%" border="1">
  <caption>실행결과</caption>
  <thead>
    <tr>
      <th>DEPARTMENT</th>
      <th>COUNT(*)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>소프트웨어학과</td>
      <td>4</td>
    </tr>
    <tr>
      <td>해고방지학과</td>
      <td>4</td>
    </tr>
    <tr>
      <td>총계</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
