---
layout: blog
title: 4.5 Top N 쿼리
date: 2025-08-26 20:00:00 +0900
categories: [TIL, sqld, 4_SQL_활용]
permalink: /blog/posts/25-08-26-TIL
---

### 4.5.1 Top N 쿼리의 개념

**Top N 쿼리** : 상위 N 순위까지의 데이터를 추출하는 쿼리. 기본적으로 순위함수를 통해 작성할 수 있다. 아래 테이블을 예시로 사용한다.

<table style="width:75%" border="1">
  <caption>STUDENT</caption>
  <thead>
    <tr>
      <th>NAME</th>
      <th>SCORE</th>
      <th>CREDITS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>남기은</td>
      <td>3.7</td>
      <td>72</td>
    </tr>
    <tr>
      <td>남윤지</td>
      <td>4.1</td>
      <td>90</td>
    </tr>
    <tr>
      <td>공은호</td>
      <td>2.6</td>
      <td>36</td>
    </tr>
    <tr>
      <td>백준혁</td>
      <td>3.5</td>
      <td>120</td>
    </tr>
    <tr>
      <td>박채민</td>
      <td>3.6</td>
      <td>54</td>
    </tr>
    <tr>
      <td>권소은</td>
      <td>4.2</td>
      <td>18</td>
    </tr>
    <tr>
      <td>안현준</td>
      <td>2.9</td>
      <td>39</td>
    </tr>
    <tr>
      <td>고도현</td>
      <td>3.7</td>
      <td>84</td>
    </tr>
  </tbody>
</table>
<br>

### 4.5.2 ROWNUM 함수

**ROWNUM** : 현재 저장된 데이터를 그대로 두고 각 행에 순차적인 번호를 붙여주는 함수.

<b>SELECT ROWNUM, NAME, SCORE, CREDITS<br>
FROM STUDENT<br>
WHERE ROWNUM <= 5;</b>

<table style="width:75%" border="1">
  <caption>실행결과</caption>
  <thead>
    <tr>
      <th>ROWNUM</th>
      <th>NAME</th>
      <th>SCORE</th>
      <th>CREDITS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>남기은</td>
      <td>3.7</td>
      <td>72</td>
    </tr>
    <tr>
      <td>2</td>
      <td>남윤지</td>
      <td>4.1</td>
      <td>90</td>
    </tr>
    <tr>
      <td>3</td>
      <td>공은호</td>
      <td>2.6</td>
      <td>36</td>
    </tr>
    <tr>
      <td>4</td>
      <td>백준혁</td>
      <td>3.5</td>
      <td>120</td>
    </tr>
    <tr>
      <td>5</td>
      <td>박채민</td>
      <td>3.6</td>
      <td>54</td>
    </tr>
  </tbody>
</table>
<br>

### 4.5.3 윈도우함수의 순위함수

윈도우함수의 순위함수로 Top N 쿼리를 작성할 수 있다.

<b>SELECT \*<br>
FROM (SELECT RANK() OVER(ORDER BY SCORE DESC) AS RANK,<br>
&nbsp;&nbsp;&nbsp;&nbsp;NAME,<br>
&nbsp;&nbsp;&nbsp;&nbsp;SCORE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;CREDITS<br>
&nbsp;&nbsp;&nbsp;&nbsp;FROM STUDENT)<br>
WHERE D_RANK <= 5;</b>

<table style="width:75%" border="1">
  <caption>STUDENT</caption>
  <thead>
    <tr>
      <th>RANK</th>
      <th>NAME</th>
      <th>SCORE</th>
      <th>CREDITS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>권소은</td>
      <td>4.2</td>
      <td>18</td>
    </tr>
    <tr>
      <td>2</td>
      <td>남윤지</td>
      <td>4.1</td>
      <td>90</td>
    </tr>
    <tr>
      <td>3</td>
      <td>남기은</td>
      <td>3.7</td>
      <td>72</td>
    </tr>
    <tr>
      <td>3</td>
      <td>고도현</td>
      <td>3.7</td>
      <td>84</td>
    </tr>
    <tr>
      <td>4</td>
      <td>박채민</td>
      <td>3.6</td>
      <td>54</td>
    </tr>
    <tr>
      <td>5</td>
      <td>백준혁</td>
      <td>3.5</td>
      <td>120</td>
    </tr>
  </tbody>
</table>
